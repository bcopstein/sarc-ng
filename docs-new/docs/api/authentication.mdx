---
sidebar_position: 2
---

# Authentication

Authentication methods and security practices for the SARC-NG API.

import Mermaid from "@theme/Mermaid";

## Authentication Status

Authentication is currently under development and will be implemented using JSON Web Tokens (JWT).

## Planned Authentication Flow

<Mermaid chart={`
sequenceDiagram
    participant Client
    participant API
    participant Auth
    participant Database

    Client->>API: POST /api/v1/auth/login (credentials)
    API->>Auth: Validate credentials
    Auth->>Database: Query user
    Database-->>Auth: User data
    Auth->>Auth: Verify password
    Auth->>Auth: Generate JWT token
    Auth-->>API: Authentication result
    API-->>Client: JWT token (if successful)

    Note over Client,API: Subsequent requests
    Client->>API: Request with Bearer token
    API->>Auth: Verify token
    Auth-->>API: Token validity & user info
    API->>API: Check permissions
    API-->>Client: Requested resource

`}/>

## Using Bearer Tokens

Once implemented, authentication will use Bearer tokens in the Authorization header:

```http
GET /api/v1/buildings
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c
```

## Token Format

JWT tokens consist of three parts separated by dots: header, payload, and signature.

```
[header].[payload].[signature]
```

### Header

```json
{
  "alg": "HS256",
  "typ": "JWT"
}
```

### Payload

```json
{
  "sub": "1234567890", // User ID
  "name": "John Doe",
  "role": "admin",
  "iat": 1516239022,
  "exp": 1516242622
}
```

### Example Token

```
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwicm9sZSI6ImFkbWluIiwiaWF0IjoxNTE2MjM5MDIyLCJleHAiOjE1MTYyNDI2MjJ9.xYbGOAP4l0bT0aKbJO9CfOqj6I-H-3-yk_pOfJ_6CsI
```

## Token Lifecycle

<Mermaid
  chart={`
stateDiagram-v2
    [*] --> Issued: Login Success
    Issued --> Active: Immediate
    Active --> Active: Valid API Request
    Active --> Expired: TTL Exceeded
    Active --> Revoked: User Logout
    Active --> Revoked: Admin Action
    Expired --> [*]
    Revoked --> [*]
`}
/>

JWT tokens will have the following lifecycle:

- **Issued**: Generated upon successful login
- **Active**: Used for API requests
- **Expired**: No longer valid after TTL (time-to-live) ends
- **Revoked**: Manually invalidated by user logout or admin action

## Refresh Tokens

To provide a better user experience, the authentication system will support refresh tokens:

1. Short-lived access tokens (30 minutes)
2. Longer-lived refresh tokens (7 days)
3. Refresh endpoint to obtain new access tokens

```http
POST /api/v1/auth/refresh
Content-Type: application/json

{
  "refresh_token": "eyJhbGciOiJIUzI1NiIs..."
}
```

## Implementation Details

### Login Endpoint

```http
POST /api/v1/auth/login
Content-Type: application/json

{
  "username": "user@example.com",
  "password": "secure_password"
}
```

**Success Response (200):**

```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIs...",
  "refresh_token": "eyJhbGciOiJIUzI1NiIs...",
  "expires_in": 1800,
  "token_type": "Bearer"
}
```

### Logout Endpoint

```http
POST /api/v1/auth/logout
Authorization: Bearer eyJhbGciOiJIUzI1NiIs...
```

**Success Response (204):** No content

### Handling Authentication Errors

When authentication fails, the API will respond with:

**Unauthorized (401):**

```json
{
  "code": 401,
  "error": "Unauthorized",
  "message": "Invalid or expired token"
}
```

**Forbidden (403):**

```json
{
  "code": 403,
  "error": "Forbidden",
  "message": "Insufficient permissions"
}
```

## Security Best Practices

The SARC-NG authentication system follows these security best practices:

1. **HTTPS Only**: All API requests should use HTTPS
2. **Secure Cookie Attributes**: HttpOnly, Secure, and SameSite flags
3. **Rate Limiting**: Prevents brute force attacks
4. **Password Hashing**: bcrypt with appropriate work factor
5. **Short-Lived Tokens**: Access tokens expire after 30 minutes
6. **Token Revocation**: Support for invalidating tokens

## Current Development Status

Authentication is planned for implementation in upcoming releases. Until then:

1. Development environments have no authentication
2. Production deployments should use API Gateway or similar service for authentication
3. Internal networks should be secured through network controls

## Next Steps

- [Learn about pagination](pagination)
- [View error handling guidelines](error-handling)
- [Check out integration examples](examples/javascript)
